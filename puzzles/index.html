<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Gülce Kardeş – Puzzles</title>
  <link href="https://fonts.googleapis.com/css2?family=Volkorn:wght@400;700&family=Mate:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: Palatino, serif;
      background: #fafafa;
      overflow-y: scroll;
    }
    header {
      background: white;
      padding: 1rem;
      text-align: center;
      font-family: Volkorn, serif;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .nav-links a {
      margin: 0 10px;
      color: navy;
      text-decoration: none;
      font-size: 1.1rem;
    }
    .nav-links a.active { font-weight: bold; }
    #pieces {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      padding: 1rem;
      justify-content: flex-start;
    }
    figure {
      width: 200px;
      text-align: center;
      margin: 0;
    }
    figcaption {
      font-family: Palatino, serif;
      font-weight: bold;
      margin-bottom: 5px;
    }
    canvas {
      width: 200px;
      height: 200px;
      display: block;
      cursor: grab;
      background: white;
    }
    canvas:active { cursor: grabbing; }
  </style>
</head>
<body>
  <header>
    <div class="nav-links">
      <a href="../index.html">Home</a>
      <a href="#" class="active">Puzzles</a>
      <a href="https://scholar.google.com/citations?user=-io3rR0AAAAJ">Google Scholar</a>
    </div>
  </header>

  <div id="pieces"></div>

  <script>
  // --- JSON definition of your 7 Soma pieces ---
  const pieces = [
    { name:"V", coords:[[0,0,0],[0,0,1],[0,1,0]],             color:"#e6194B" },
    { name:"L", coords:[[0,0,0],[0,0,1],[0,0,2],[0,1,0]],     color:"#3cb44b" },
    { name:"T", coords:[[0,0,0],[0,0,1],[0,0,2],[0,1,1]],     color:"#4363d8" },
    { name:"Z", coords:[[0,0,0],[0,0,1],[0,1,0],[1,0,0]],     color:"#f58231" },
    { name:"A", coords:[[0,0,0],[0,0,1],[0,1,0],[1,0,1]],     color:"#911eb4" },
    { name:"B", coords:[[0,0,0],[0,0,1],[0,1,0],[1,1,0]],     color:"#46f0f0" },
    { name:"P", coords:[[0,0,0],[0,0,1],[0,1,1],[0,1,2]],     color:"#f032e6" }
  ];

  // three visible faces per cube (top, left, right)
  const faces = [
    { verts:[[0,1,0],[1,1,0],[1,1,1],[0,1,1]], shade:1.00 },
    { verts:[[0,0,0],[0,1,0],[0,1,1],[0,0,1]], shade:0.85 },
    { verts:[[1,0,0],[1,0,1],[1,1,1],[1,1,0]], shade:0.70 }
  ];

  const container = document.getElementById("pieces");

  // helper: shade a hex color toward white
  function shadeColor(hex, s) {
    const r=parseInt(hex.slice(1,3),16),
          g=parseInt(hex.slice(3,5),16),
          b=parseInt(hex.slice(5,7),16);
    const nr=Math.round(r*s + 255*(1-s)),
          ng=Math.round(g*s + 255*(1-s)),
          nb=Math.round(b*s + 255*(1-s));
    return `rgb(${nr},${ng},${nb})`;
  }

  // create one 'piece instance' with its own canvas & state
  function makePiece(p){
    // build DOM
    const fig = document.createElement("figure");
    const cap = document.createElement("figcaption");
    cap.textContent = p.name;
    fig.appendChild(cap);

    const canvas = document.createElement("canvas");
    canvas.width = 200;
    canvas.height = 200;
    fig.appendChild(canvas);
    container.appendChild(fig);

    const ctx = canvas.getContext("2d");
    // rotation state
    let rotX = Math.PI/6, rotY = -Math.PI/6;
    let dragging=false, lastX=0, lastY=0;
    // compute centroid (for centering)
    const n = p.coords.length;
    let sumX=0,sumY=0,sumZ=0;
    p.coords.forEach(c=>{ sumX+=c[0]; sumY+=c[1]; sumZ+=c[2]; });
    const center = [sumX/n+0.5, sumY/n+0.5, sumZ/n+0.5];

    // projection
    function project(pt){
      let [x,y,z]=pt;
      // rotate Y
      const cY=Math.cos(rotY), sY=Math.sin(rotY);
      let dx=cY*x + sY*z, dz=-sY*x + cY*z, dy=y;
      // rotate X
      const cX=Math.cos(rotX), sX=Math.sin(rotX);
      let dy2=cX*dy - sX*dz, dz2=sX*dy + cX*dz;
      const scale=40;
      return {
        x: canvas.width/2 + dx*scale,
        y: canvas.height/2 - dy2*scale,
        depth: dz2
      };
    }

    // draw the piece
    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // collect cubes with depth:
      const arr = [];
      p.coords.forEach(c=>{
        const wx=c[0]-center[0], wy=c[1]-center[1], wz=c[2]-center[2];
        const pr = project([wx,wy,wz]);
        arr.push({wx,wy,wz,depth:pr.depth});
      });
      // painter’s sort
      arr.sort((a,b)=>a.depth-b.depth);
      // draw faces
      arr.forEach(d=>{
        faces.forEach(f=>{
          const pts = f.verts.map(v=>project([d.wx+v[0], d.wy+v[1], d.wz+v[2]]));
          ctx.beginPath();
          ctx.moveTo(pts[0].x, pts[0].y);
          pts.slice(1).forEach(p2=>ctx.lineTo(p2.x,p2.y));
          ctx.closePath();
          ctx.fillStyle = shadeColor(p.color, f.shade);
          ctx.fill();
          ctx.strokeStyle = "#333";
          ctx.stroke();
        });
      });
    }

    // mouse events for rotation
    canvas.addEventListener("mousedown", e=>{
      dragging=true; lastX=e.clientX; lastY=e.clientY;
    });
    window.addEventListener("mousemove", e=>{
      if(!dragging) return;
      const dx=e.clientX-lastX, dy=e.clientY-lastY;
      rotY += dx*0.01;
      rotX += dy*0.01;
      lastX=e.clientX; lastY=e.clientY;
      draw();
    });
    window.addEventListener("mouseup", ()=>dragging=false);
    window.addEventListener("mouseleave", ()=>dragging=false);

    // initial paint
    draw();
  }

  // build all pieces
  pieces.forEach(makePiece);

  </script>
</body>
</html>
